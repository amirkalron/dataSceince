<html><head>
<title>solution.py</title>
<meta name="Generator" content="htmlizer/[twisted, version 13.2.0]" />
<link rel="alternate" href="solution.py" type="text/x-python" />

</head>
<body>
<pre><span class="py-src-keyword">import</span> <span class="py-src-variable">csv</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">csv</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">numpy</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">np</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">pandas</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">pandas</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">sklearn</span>
<span class="py-src-keyword">from</span> <span class="py-src-variable">sklearn</span>.<span class="py-src-variable">ensemble</span> <span class="py-src-keyword">import</span> <span class="py-src-variable">RandomForestClassifier</span>
<span class="py-src-keyword">from</span> <span class="py-src-variable">solutionHelper</span> <span class="py-src-keyword">import</span> <span class="py-src-variable">fixData</span>
<span class="py-src-keyword">from</span> <span class="py-src-variable">solutionHelper</span> <span class="py-src-keyword">import</span> <span class="py-src-variable">getPredictors</span>

<span class="py-src-comment">#init predicators</span>
<span class="py-src-variable">predictors</span> = <span class="py-src-variable">getPredictors</span>()
<span class="py-src-variable">algType</span> = <span class="py-src-string">"Random forest"</span>
<span class="py-src-keyword">print</span> <span class="py-src-string">"solution using : "</span> + <span class="py-src-variable">algType</span>

<span class="py-src-comment">##############################</span>
<span class="py-src-comment"># fix train data + predict on train data with cross validation</span>
<span class="py-src-comment">##############################</span>
<span class="py-src-variable">titanic</span> = <span class="py-src-variable">pandas</span>.<span class="py-src-variable">read_csv</span>(<span class="py-src-string">"train.csv"</span>)
<span class="py-src-variable">fixData</span>(<span class="py-src-variable">titanic</span>)

<span class="py-src-comment">#just estimate prediction rate</span>
<span class="py-src-variable">alg</span> = <span class="py-src-variable">RandomForestClassifier</span>(<span class="py-src-variable">random_state</span>=<span class="py-src-number">1</span>, <span class="py-src-variable">n_estimators</span>=<span class="py-src-number">150</span>, <span class="py-src-variable">min_samples_split</span>=<span class="py-src-number">4</span>, <span class="py-src-variable">min_samples_leaf</span>=<span class="py-src-number">2</span>)
<span class="py-src-variable">scores</span> = <span class="py-src-variable">sklearn</span>.<span class="py-src-variable">cross_validation</span>.<span class="py-src-variable">cross_val_score</span>(<span class="py-src-variable">alg</span>, <span class="py-src-variable">titanic</span>[<span class="py-src-variable">predictors</span>], <span class="py-src-variable">titanic</span>[<span class="py-src-string">"Survived"</span>], <span class="py-src-variable">cv</span>=<span class="py-src-number">3</span>)
<span class="py-src-keyword">print</span> <span class="py-src-variable">scores</span>.<span class="py-src-variable">mean</span>()

<span class="py-src-comment">###########################################</span>
<span class="py-src-comment"># fix test data + predict on test data</span>
<span class="py-src-comment">###########################################</span>
<span class="py-src-variable">titanic_test</span> = <span class="py-src-variable">pandas</span>.<span class="py-src-variable">read_csv</span>(<span class="py-src-string">"test.csv"</span>) 
<span class="py-src-variable">fixData</span>(<span class="py-src-variable">titanic_test</span>)

<span class="py-src-comment">#train + predict</span>
<span class="py-src-comment">#alg = LogisticRegression(random_state=1)</span>
<span class="py-src-variable">alg</span> = <span class="py-src-variable">RandomForestClassifier</span>(<span class="py-src-variable">random_state</span>=<span class="py-src-number">1</span>, <span class="py-src-variable">n_estimators</span>=<span class="py-src-number">150</span>, <span class="py-src-variable">min_samples_split</span>=<span class="py-src-number">4</span>, <span class="py-src-variable">min_samples_leaf</span>=<span class="py-src-number">2</span>)
<span class="py-src-variable">alg</span>.<span class="py-src-variable">fit</span>(<span class="py-src-variable">titanic</span>[<span class="py-src-variable">predictors</span>], <span class="py-src-variable">titanic</span>[<span class="py-src-string">"Survived"</span>])
<span class="py-src-variable">predictions</span> = <span class="py-src-variable">alg</span>.<span class="py-src-variable">predict</span>(<span class="py-src-variable">titanic_test</span>[<span class="py-src-variable">predictors</span>])

<span class="py-src-comment">#submit</span>
<span class="py-src-variable">submission</span> = <span class="py-src-variable">pandas</span>.<span class="py-src-variable">DataFrame</span>({
        <span class="py-src-string">"PassengerId"</span>: <span class="py-src-variable">titanic_test</span>[<span class="py-src-string">"PassengerId"</span>],
        <span class="py-src-string">"Survived"</span>: <span class="py-src-variable">predictions</span>
    })

<span class="py-src-variable">submission</span>.<span class="py-src-variable">to_csv</span>(<span class="py-src-string">"prediction.csv"</span>,<span class="py-src-variable">index</span>=<span class="py-src-variable">False</span>)
</pre>
</body>